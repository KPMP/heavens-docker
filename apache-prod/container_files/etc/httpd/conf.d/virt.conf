ServerName upload.kpmp.org
Listen 443

<VirtualHost *:80>

  ServerName upload.kpmp.org
  RewriteEngine on
  RewriteCond %{HTTPS}  off
  RewriteRule ^/(.*)$   https://upload.kpmp.org/$1 [L,R]

</VirtualHost>

<VirtualHost *:443>

  ServerName upload.kpmp.org

  SSLEngine on
  SSLProtocol +TLSv1.2
  SSLHonorCipherOrder on
  SSLCipherSuite HIGH
  SSLCertificateFile /etc/pki/tls/certs/kpmp.crt
  SSLCertificateKeyFile /etc/pki/tls/private/kpmp.key

  <Files *.sso>
    SetHandler shib-handler
  </Files>

  <Location "/">
    AuthType shibboleth
	ShibRequireSession On
    Require valid-user
  </Location>

  RewriteEngine	on
  RewriteRule	"^/api/(.*)$"	 "http://spring:3030/$1"	[P]

</VirtualHost>

